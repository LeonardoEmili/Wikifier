           Autocorrelation, also known as serial correlation, is the  |correlation|Correlation|  of a  |signal|Signal|  with a delayed copy of itself as a function of delay. Informally, it is the similarity between observations as a function of the time lag between them. The analysis of autocorrelation is a mathematical tool for finding repeating patterns, such as the presence of a  |periodic_signal|Periodic_Signal|  obscured by  |noise|Noise| , or identifying the  |missing_fundamental_frequency|Missing_Fundamental_Frequency|  in a signal implied by its  |harmonic|Harmonic|  frequencies. It is often used in  |signal_processing|Signal_Processing|  for analyzing functions or series of values, such as  |time_domain|Time_Domain|  signals.     Different fields of study define autocorrelation differently, and not all of these definitions are equivalent. In some fields, the term is used interchangeably with  |autocovariance|Autocovariance| .      |Unit_root|Unit_Root|  processes,  |trend_stationary|Trend_Stationary|  processes,  |autoregressive_process|Autoregressive_Process| es, and  |moving_average_process|Moving_Average_Process| es are specific forms of processes with autocorrelation.       In  |statistics|Statistics| , the autocorrelation of a real or complex  |random_process|Random_Process|  is the  |Pearson_correlation|Pearson_Correlation_Coefficient|  between values of the process at different times, as a function of the two times or of the time lag . Let   be a random process, and t be any point in time . Then Xt is the value  produced by a given  |run|Execution|  of the process at time t . Suppose that the process has  |mean|Mean|    and  |variance|Variance|    at time t , for each t . Then the definition of the auto-correlation function between times t1 and t2 is   Kun Il Park, Fundamentals of Probability and Stochastic Processes with Applications to Communications, Springer, 2018,            where   is the  |expected_value|Expected_Value|  operator and the bar represents complex conjugation. Note that the expectation may be not well defined.     Subtracting the mean before multiplication yields the auto-covariance function between times t1 and t2 :            Note that this expression is not well-defined for all-time series or processes, because the mean may not exist, or the variance may be zero or infinite .       If   is a  |wide-sense_stationary_process|Wide-Sense_Stationary_Process|  then the mean   and the variance   are time-independent, and further the autocovariance function depends only on the lag between t1 and t2 : the autocovariance depends only on the time-distance between the pair of values but not on their position in time. This further implies that the autocovariance and auto-correlation can be expressed as a function of the time-lag, and that this would be an  |even_function|Even_Function|  of the lag   . This gives the more familiar forms for the auto-correlation function           and the auto-covariance function       It is common practice in some disciplines  to normalize the autocovariance function to get a time-dependent  |Pearson_correlation_coefficient|Pearson_Correlation_Coefficient| . However, in other disciplines the normalization is usually dropped and the terms autocorrelation and autocovariance are used interchangeably.     The definition of the auto-correlation coefficient of a stochastic process is      :       .     If the function   is well-defined, its value must lie in the range , with 1 indicating perfect correlation and −1 indicating perfect  |anti-correlation|Anti-Correlation| .     For a weak-sense  |stationarity,_wide-sense_stationarity|Stationary_Processweak_Or_Wide-Sense_Stationarity|  process, the definition is     :           where     :     .     The normalization is important both because the interpretation of the autocorrelation as a correlation provides a scale-free measure of the strength of  |statistical_dependence|Statistical_Dependence| , and because the normalization has an effect on the statistical properties of the estimated autocorrelations.         The fact that the auto-correlation function   this is an  |even_function|Even_Function|  can be stated as    :       Respectively for WSS a process:    :     .       For a WSS process:    :         Notice that   is always real.       The  |Cauchy–Schwarz_inequality|Cauchy–Schwarz_Inequality| , inequality for stochastic processes:    :               The autocorrelation of a continuous-time  |white_noise|White_Noise|  signal will have a strong peak  at   and will be exactly 0 for all other   .       The  |Wiener–Khinchin_theorem|Wiener–Khinchin_Theorem|  relates the autocorrelation function   to the  |power_spectral_density|Spectral_Density|  S via the  |Fourier_transform|Fourier_Transform| |Wiener–Khinchin_theorem|Wiener–Khinchin_Theorem|  can be re-expressed in terms of real cosines only:     :     S     f     : S           .     auto-correlation matrix of a  |random_vector|Random_Vector|    is an n   n matrix containing as elements the  |autocorrelations|Autocorrelation|  of all pairs of elements of the random vector   . The autocorrelation matrix is used in various digital signal processing algorithms.     For a  |random_vector|Random_Vector|    containing  |random_elements|Random_Element|  whose  |expected_value|Expected_Value|  and  |variance|Variance|  exist, the auto-correlation matrix is defined by Papoulis, Athanasius, Probability, Random variables and Stochastic processes, McGraw-Hill, 1991             where denotes transposition and has dimensions n   n .     Written component-wise:     :           &   &   &           &   &   &           &   &   &           &   &   &                 If   is a  |complex_random_vector|Complex_Random_Vector| , the autocorrelation matrix is instead defined by     :       .     Here denotes  |Hermitian_transposition|Hermitian_Transpose| .     For example, if     is a random vectors, then   is a 3   3 matrix whose -th entry is   .       The autocorrelation matrix is a  |Hermitian_matrix|Hermitian_Matrix|  for complex random vectors and a  |symmetric_matrix|Symmetric_Matrix|  for real random vectors.  , i.e.         0           for a real random vector respectively         0           in case of a complex random vector.   All eigenvalues of the autocorrelation matrix are real and non-negative.   The auto-covariance matrix is related to the autocorrelation matrix as follows:   :       -       : Respectively for complex random vectors:   :       -           In  |signal_processing|Signal_Processing| , the above definition is often used without the normalization, that is, without subtracting the mean and dividing by the variance. When the autocorrelation function is normalized by mean and variance, it is sometimes referred to as the autocorrelation coefficient  or autocovariance function.       Given a  |signal|Signal|  f , the continuous autocorrelation R is most often defined as the continuous cross-correlation integral of f with itself, at lag   .           where   represents the  |complex_conjugate|Complex_Conjugate|  of f . Note that the parameter t in the integral is a dummy variable and is only necessary to calculate the integral. It has no specific meaning.       The discrete autocorrelation R at lag   for a discrete-time signal y is          The above definitions work for signals that are square integrable, or square summable, that is, of finite energy. Signals that last forever are treated instead as random processes, in which case different definitions are needed, based on expected values. For  |wide-sense-stationary_random_processes|Stationary_Process| , the autocorrelations are defined as     : R     : R       For processes that are not  |stationary|Stationary_Process| , these will also be functions of t , or n .     For processes that are also  |ergodic|Ergodic_Process| , the expectation can be replaced by the limit of a time average. The autocorrelation of an ergodic process is sometimes defined as or equated to     : R     1 T   f  t   : R     1 N   y      These definitions have the advantage that they give sensible well-defined single-parameter results for periodic functions, even when those functions are not the output of stationary ergodic processes.     Alternatively, signals that last forever can be treated by a short-time autocorrelation function analysis, using finite time integrals.        If f is a continuous periodic functions of period T , the integration from -  to   is replaced by integration over any interval of length T :     : R     f         which is equivalent to     : R     f           In the following, we will describe properties of one-dimensional autocorrelations only, since most properties are easily transferred from the one-dimensional case to the multi-dimensional cases. These properties hold for  |wide-sense_stationary_processes|Stationary_Processweak_Or_Wide-Sense_Stationarity| .      A fundamental property of the autocorrelation is symmetry, R R , which is easy to prove from the definition. In the continuous case,   :the autocorrelation is an  |even_function|Even_Function|      :: R R  when f is a real function,     :and the autocorrelation is a  |Hermitian_function|Hermitian_Function|      :: R R  when f is a  |complex_function|Complex_Function| .     The continuous autocorrelation function reaches its peak at the origin, where it takes a real value, i.e. for any delay   ,  R    R .  This is a consequence of the  |rearrangement_inequality|Rearrangement_Inequality| . The same result holds in the discrete case.   The autocorrelation of a  |periodic_function|Periodic_Function|  is, itself, periodic with the same period.   The autocorrelation of the sum of two completely uncorrelated functions is the sum of the autocorrelations of each function separately.   Since autocorrelation is a specific type of  |cross-correlation|Cross-Correlation| , it maintains all the properties of cross-correlation.   By using the symbol to represent  |convolution|Convolution|  and g is a function which manipulates the function f and is defined as gf , the definition for R may be written as:     :: R       Multi- |dimension|Dimension| al autocorrelation is defined similarly. For example, in  |three_dimensions|Three-Dimensional_Space|  the autocorrelation of a square-summable  |discrete_signal|Discrete_Signal|  would be     : R   x  .     When mean values are subtracted from signals before computing an autocorrelation function, the resulting function is usually called an auto-covariance function.       For data expressed as a  |discrete|Discrete_Signal|  sequence, it is frequently necessary to compute the autocorrelation with high  |computational_efficiency|Algorithmic_Efficiency| . A brute force method based on the signal processing definition R   xn  can be used when the signal size is small. For example, to calculate the autocorrelation of the real signal sequence x  by hand, we first recognize that the definition just given is the same as the usual multiplication, but with right shifts, where each vertical addition gives the autocorrelation for particular lag values:   :     & 2 & 3 & -1       & 2 & 3 & -1         & -2 & -3 & 1     & & 6 & 9 & -3     + & & & 4 & 6 & -2         & -2 & 3 & 14 & 3 & -2         Thus the required autocorrelation sequence is R , where R14, R R3, and R R -2, the autocorrelation for other lag values being zero. In this calculation we do not perform the carry-over operation during addition as is usual in normal multiplication. Note that we can halve the number of operations required by exploiting the inherent symmetry of the autocorrelation. If the signal happens to be periodic, i.e. x, then we get a circular autocorrelation  where the left and right tails of the previous autocorrelation sequence will overlap and give R which has the same period as the signal sequence x. The procedure can be regarded as an application of the convolution property of  |z-transform|Z-Transform|  of a discrete signal.     While the brute force algorithm is  |order|Big_O_Notation|  , several efficient algorithms exist which can compute the autocorrelation in order . For example, the  |Wiener–Khinchin_theorem|Wiener–Khinchin_Theorem|  allows computing the autocorrelation from the raw data  with two  |fast_Fourier_transforms|Fast_Fourier_Transform|  :      :     FR &       S & FR FR     R &           where IFFT denotes the inverse  |fast_Fourier_transform|Fast_Fourier_Transform| . The asterisk denotes  |complex_conjugate|Complex_Conjugate| .     Alternatively, a multiple  correlation can be performed by using brute force calculation for low  values, and then progressively binning the  data with a  |logarithm|Logarithm| ic density to compute higher values, resulting in the same  efficiency, but with lower memory requirements.         For a  |discrete|Discrete_Signal|  process with known mean and variance for which we observe n observations   , an estimate of the autocorrelation may be obtained as     :         for any positive integer k  q .         Autocorrelation analysis is used heavily in  |fluorescence_correlation_spectroscopy|Fluorescence_Correlation_Spectroscopy| .   Another application of autocorrelation is the measurement of  |optical_spectra|Optical_Spectrum|  and the measurement of very-short-duration  |light|Light| |pulses|Ultrashort_Pulse|  produced by  |lasers|Laser| , both using  |optical_autocorrelators|Optical_Autocorrelation| .   Autocorrelation is used to analyze  |dynamic_light_scattering|Dynamic_Light_Scattering|  data, which notably enables determination of the  |particle_size_distributions|Particle_Size_Distribution|  of nanometer-sized particles or  |micelles|Micelle|  suspended in a fluid. A laser shining into the mixture produces a  |speckle_pattern|Speckle_Pattern|  that results from the motion of the particles. Autocorrelation of the signal can be analyzed in terms of the diffusion of the particles. From this, knowing the viscosity of the fluid, the sizes of the particles can be calculated.   The  |small-angle_X-ray_scattering|Small-Angle_X-Ray_Scattering|  intensity of a nanostructured system is the Fourier transform of the spatial autocorrelation function of the electron density.   In optics, normalized autocorrelations and cross-correlations give the  |degree_of_coherence|Degree_Of_Coherence|  of an electromagnetic field.   In  |signal_processing|Signal_Processing| , autocorrelation can give information about repeating events like  |music|Music| al  |beats|Beat|   or  |pulsar|Pulsar| |frequencies|Frequency| , though it cannot tell the position in time of the beat. It can also be used to  |estimate_the_pitch_of_a_musical_tone|Pitch_Detection_Algorithm| .   In  |music_recording|Music_Recording| , autocorrelation is used as a  |pitch_detection_algorithm|Pitch_Detection_Algorithm|  prior to vocal processing, as a distortion effect or to eliminate undesired mistakes and inaccuracies.      Autocorrelation in space rather than time, via the  |Patterson_function|Patterson_Function| , is used by X-ray diffractionists to help recover the Fourier phase information on atom positions not available through diffraction alone.   In statistics, spatial autocorrelation between sample locations also helps one estimate  |mean_value_uncertainties|Variancegeneralizations|  when sampling a heterogeneous population.   The  |SEQUEST|Sequest|  algorithm for analyzing  |mass_spectra|Mass_Spectrum|  makes use of autocorrelation in conjunction with  |cross-correlation|Cross-Correlation|  to score the similarity of an observed spectrum to an idealized spectrum representing a  |peptide|Peptide| .   In  |astrophysics|Astrophysics| , autocorrelation is used to study and characterize the spatial distribution of  |galaxies|Galaxy|  in the universe and in multi-wavelength observations of low mass  |X-ray_binaries|X-Ray_Binary| .   In  |panel_data|Panel_Data| , spatial autocorrelation refers to correlation of a variable with itself through space.   In analysis of  |Markov_chain_Monte_Carlo|Markov_Chain_Monte_Carlo|  data, autocorrelation must be taken into account for correct error determination.   In geosciences it can be used to compute an autocorrelation seismic attribute, out of a 3D seismic survey of the underground.   In  |medical_ultrasound|Medical_Ultrasound|  imaging, autocorrelation is used to visualize blood flow.   In  |intertemporal_portfolio_choice|Intertemporal_Portfolio_Choice| , the presence or absence of autocorrelation in an assets  |rate_of_return|Rate_Of_Return|  can affect the optimal portion of the portfolio to hold in that asset.       Serial dependence is closely linked to the notion of autocorrelation, but represents a distinct concept . In particular, it is possible to have serial dependence but no correlation. In some fields however, the two terms are used as synonyms.     A  |time_series|Time_Series|  of a  |random_variable|Random_Variable|  has serial dependence if the value at some time t in the series is  |statistically_dependent|Statistical_Independence|  on the value at another time s . A series is serially independent if there is no dependence between any pair.     If a time series   is  |stationary|Stationary_Process| .